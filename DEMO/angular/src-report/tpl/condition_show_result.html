<!-- 展示结果 -->
<div class="condition_div">
	<li>
        <div class="item-content item-relative">
            <label><span tkey="show_results"></span>:</label>
            <div class="item-input">
              	<!--relative-value 表示 一个输入框 对应 一个 右侧划入的列表-->
              	<input type="text" placeholder="请选择需展示的结果" class="btn-panel relative-value" data-rel="panel-result" readonly="" data-value="storage6" value="">
            </div>
        </div>
    </li>
</div>

<div class="panel panel-right panel-cover" id='panel-result'>
    <header>
    <a href="#" class="close-panel back"></a>  
    <span tkey="show_results"></span>
    <a href="#" class="close-panel confirm confirm_6" tkey="sure"></a>
    </header>
    <!-- Click on link with "close-panel" class will close panel -->
    <div class="list-block">
      <p class="small" tkey="total_desc"></p>
      <ul>
        <!-- Single chekbox item -->
        <li tkey="loading"></li>
      </ul>
    </div>
</div>


<script>
	jQuery(document).ready(function($){
	    $('.condition_div li').appendTo($('#condition_ul'));

    	//init 展示结果
        if(xhr1){
          xhr1.abort();
        }
        xhr1 = $.ajax({
	        url: API_URL_PREFIX+API_URL['employee_sale_calc_type'],
	        data: JSON.stringify({}),
	        type: 'POST',
	        dataType : "json",
	        contentType: "application/json",
	        success:  function(data){
	            if(data.code != 0){
	              	_error_handle(data);
	            	return;
	        	}
            	data = data.data;
                var str = '';
                var checked_result = '';
                var calc_type = form_id + '_calc_type';
                for(i=0;i<data.data.length;i++){
                    var name = data.data[i]['type_name'];
                    var code = data.data[i]['type_code'];
                    if(!!localStorage[calc_type]){
                          checked_result = (localStorage[calc_type].split(',').indexOf(code+'') != -1)?'checked':'';
                        }
                    str += '<li><label class="lb" for="result'+i+'">\
                            '+ name +'\
                            <span class="checkbox">\
                              <span class="input-radio '+ checked_result +'">\
                                <input type="radio" name="result" id="result'+i+'" value="'+ code +'" data-label="'+ name +'" />\
                                <span class="inner"></span>\
                              </span>\
                            </span></label>\
                          </li>';
                }
                $('#panel-result ul').html(str);
                $(document).on("click", "#panel-result .close-panel.confirm_6", function() {
                    var s = '';
                    if($(this).parents('.panel').find('input[type=radio]').size() == $(this).parents('.panel').find('input[type=radio]:checked').size()){
                      	s = '全部展示结果';
                    }else{
						$(this).parents('.panel').find('input[type=radio]:checked').each(function(){
                          	if(s != ''){
                              	s += ',';
                          	}
                          	s +=  $(this).attr('data-label');
                      	});
                    }
                    $('input[data-value="storage6"]').val(s);
                    // sessionStorage.setItem('total',s);
                    $('.filter_result').html(s);
                });
              	//判断 localStorage 缓存
              	var filter_result = form_id + '_filter_result';
              	if(!!localStorage[filter_result]){
	                $('.filter_result').html(localStorage[filter_result]);
	                $('input[data-value="storage6"]').val(localStorage[filter_result]);
	                var calc_type_arr = localStorage[calc_type].split(',');
	                for(var i=0;i<calc_type_arr.length;i++){
	                  	$("#panel-result ul li .input-radio input[value='"+calc_type_arr[i]+"']").click();
	                }
              	}else{
                	// 默认选中
                	$('#panel-result ul li:first-child .input-radio input').click();
              	}
              	$('#panel-result .close-panel.confirm_6').click();
          	},
          	error:    function(data){
            	console.log('error');
            	_error_handle(data);
          	},
          	complete: function(){
            	console.log('complete');
          	},
          	beforeSend : function(request){
            	request.setRequestHeader("token", token);
           	}
        })
	})
</script>