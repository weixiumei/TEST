<!DOCTYPE html>
<html ng-app="NtSF" ng-cloak="" class="ng-cloak">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-cache">

    <meta name="viewport" content="width=device-width, initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">

    <meta name="author" content="zsy">
    <meta name="keywords" content="table, analysis">
    <meta name="description" content="Query goods gross margin">
    <meta name="robots" content="index, follow">

    <meta name="apple-mobile-web-app-title" content="landing">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="">
    <link rel="stylesheet" type="text/css" href="static/lzsale/build/common.css">

    <meta name="google" value="notranslate">
    <meta name="format-detection" content="telephone=no">
    <title>视图报表</title>
    
    <script src="static/src/js/fastclick.min.js"></script>
    <script src="static/lzsale/src/js/expand.js"></script>
    <script src="static/index/js/jquery.min.js"></script>

    <!-- 新增关于日期控件 -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /> -->
    <link rel="stylesheet" href="static/lzsale/src/js/daterangepicker.min.css" />

    <!-- // <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.16.0/moment.min.js" type="text/javascript"></script> -->
    <!-- // <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" type="text/javascript"></script> -->
    <!-- // <script src="static/index/js/lang.js"></script> -->
    <script src="static/lzsale/src/js/demo.js"></script>
    <script src="static/lzsale/src/js/jquery.daterangepicker.min.js"></script>

    <!-- Bootstrap -->
    <script src="static/index/js/bootstrap.min.js"></script>
    <link href="static/index/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
        [ng\:cloak],[ng-cloak], [data-ng-cloak], [x-ng-cloak], .ng-cloak, .x-ng-cloak{
            display:none ! important;
        }
        a, body{
            color: #34495E;
        }
        .title{
            /*margin-top: 1rem;*/
            margin-left: -4px;
            font-size: 20px;
            font-family: PingFangSC-Medium;
        }
        .title::before{
            content:" ";
            position: absolute;
            width: 6px;
            height: 21px;
            margin-left: -1rem;
            margin-top: 0.9rem;
            background-color: #1296db;
            box-shadow: 0px 2px 3px 1px #eaeaea;
        }
        .datepicker{
            /*margin-top: 1rem;*/
        }
        .datepicker img, .date_img{
            width: 2rem;
            float: right;
            margin-top: 1rem;
        }
        .startDate_today{
            background-color: #f7f8fa;
            padding: .6rem 4rem ! important;
        }
        .startDate{
            background-color: #f7f8fa;
            padding: .6rem 1rem;
        }
        .header_5{
            line-height: 47px;
        }
        .date_title{
            /*margin-top: 1.4rem;*/
        }
        .nav-pills>li>a{
            line-height: 1rem;
            margin-top: 0.5rem;
        }
        ._mar{
            /*margin: 1rem 0;*/
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        .tit_mar{
            margin-bottom: 1rem;
            margin-top: 1rem;
        }
        .mar_right{
            border-right: 1px solid #eaeaea;
            border-top: 1px solid #eaeaea;
        }
        .mar_left{
            border-top: 1px solid #eaeaea;
        }
        ._right_mar{
            margin-top: 4rem;
        }
        .count_text{
            font-size: 16px;
            text-align: center;
        }
        .count{
            text-align: center;
            color: #ff6a00;
        }
        .count span{
            font-size: 24px;
            font-weight: 300;
        }
        .circle{
            width: 3rem;
            height: 3rem;
            background-color: red;
            border-radius: 50%;
        }
        .circle div{
            margin-top: 8px;
        }
        .row{
            width: 100%;
        }
        .well{
            padding: 10px;
            margin-bottom:0;
            border-radius:0;
        }
        .sale_amount{
            color: #339966;
            font-size: 24px;
        }
        .big_font{
            font-size: 24px;
        }
        .sale_count{
            color: #34495E;
            /*font-weight: 700;*/
            font-size: 24px;
        }
        #sale_on_off{
            width: 300px;
            height: 150px;
        }
        .line_on::before{
            content:" ";
            position: absolute;
            width: 1rem;
            height: 1rem;
            margin-left: -1.3rem;
            margin-top: 0.4rem;
            background-color: #FF9900;
        }
        .line_off::before{
            content:" ";
            position: absolute;
            width: 1rem;
            height: 1rem;
            margin-left: -1.3rem;
            margin-top: 0.4rem;
            background-color: #FFB97B;
        }
        .line_on_off_amount{
            font-size: 24px;
        }
        .flex_channel{
            display: flex;
            border: 1px solid #eaeaea;
        }
        .flex_lr{
            /*width: 25%; */
            display: flex;
            justify-content: flex-start;
            /* justify-content: space-evenly; */
            align-items: center;
            flex-grow: 2;
        }
        .channel_left{
            width: 94px;
            height: 100%;
            background-color: #F7F8FA;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        .channel_right {
            padding-left: 10px;
            margin: 1rem 0;
        }
        .channel_right div{
            margin: .5rem 0;
        }
        .div2{
            background-color: white; 
            margin-top:1rem; 
            /*border: 1px solid #eaeaea;*/
        }
        .staff_sort{
            display: flex;
            border: 1px solid #eaeaea;
        }
        .staff_left{
            /*margin: 1rem;*/
            width: 13%;
        }
        .tr_div{
            padding: 8px;
        }
        .staff_right{
            width: 84.5%;
            /*margin: 1rem;*/
            display: flex;
            
        }
        .right_column{
            min-width: 150px;
            border-right: 1px solid #eaeaea;
        }
        .staff_right div div{
            padding:3px;
        }
        .staff_color{
            background-color: #F7F8FA;
        }
        .tit{
            color: #34495E;
            font-size: 18px;
            font-weight: 700;
        }
        .tit_num{
            color: #DA1E24;
            font-size: 16px;
            font-weight: 700;
        }
        .tit_1{
            color: #34495E;
            font-weight: 700;
            font-size: 16px;
        }
        .tit_2{
            color: #748292;
            font-weight: 300;
            font-size: 13px;
        }
    </style>
</head>
<!DOCTYPE html>
<html lang="zh-CN" ng-app="NtSF" ng-cloak="" class="ng-cloak">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>FE</title>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="assets/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- Bootstrap -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <!-- style.less -->
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script>
        // var storage = window.localStorage;
        // var TOKEN = (!!storage.getItem('NXPB_TOKEN'))?storage.getItem('NXPB_TOKEN'):'';
        // if(!!!TOKEN){
        //     window.location.href = 'login.html';
        // }
    </script>
  </head>
<body ng-controller="form5">
    <div class="header new_header">
        <ul>
            <li style="width: 10%;height:100%"></li>
            <li>
                <a href="form.html" class="header_a" tkey="store_sale"></a>
            </li>
            <li>
                <a href="javascript:;" class="active header_a" tkey="multichannel_sale"></a>
            </li>
            <li>
                <a href="form2.html" class="header_a" tkey="store_target"></a>
            </li>
            <li>
                <a href="form3.html" class="header_a" tkey="store_week"></a>
            </li>
            <li>
                <a href="form4.html" class="header_a" tkey="kucun_analysis"></a>
            </li>
            <li style="width: 10%"></li>
        </ul>
    </div>
    <div class="well">
        <div style="background-color: white;">
            <div class="row header_5" style="margin-left:0;border:1px solid #eaeaea;border-bottom: 0;">
                <span class="blue_block"></span>
                <div class="col-md-6 title">销售统计</div>
                <div class="col-md-3">
                    <ul class="nav nav-pills">
                        <li role="presentation" ng-class="{active:search_type=='today'}" ng-click="getData('today')"><a>实时查询</a></li>
                        <li role="presentation" ng-class="{active:search_type=='history'}" ng-click="getData('yestoday')"><a>历史查询</a></li>
                    </ul>
                </div>
                <div ng-show="search_type=='today'" class="col-md-3 date_title">
                    <!-- <div class="datepicker" id="datepicker" display=""> -->
                        <span class="startDate_today">{{startDate}}</span>
                        <img class="date_img" src="static/lzsale/src/img/date_disabled.png" alt="">
                    <!-- </div> -->
                </div>
                <div ng-show="search_type!='today'" class="col-md-3 date_title">
                    <div class="datepicker" name="daterange" id="datepicker" display="">
                        <span ng-class="{startDate_today:yestoday_class}" class="startDate">{{startDate}}</span>
                        <img src="static/lzsale/src/img/date.png" alt="">
                    </div>
                </div>
            </div>
            <div class="row" style="margin-left:0;border:1px solid #eaeaea;border-bottom: 0;">
                <div class="col-md-6">
                    <div class="row"><div class="col-md-5 col-md-offset-5 tit_mar">线上、线下销售合计</div></div>
                    <div class="row _mar">
                        <div class="col-md-5">销售额</div>
                        <div class="col-md-7 sale_amount">{{data.total_amount|currency : ''}}</div><!-- |currency:'￥' -->
                    </div>
                    <div class="row _mar">
                        <div class="col-md-5">销售单数</div>
                        <div class="col-md-7 sale_count">{{data.order_count}}笔</div>
                    </div>
                    <div class="row _mar">
                        <div class="col-md-5">销售数量</div>
                        <div class="col-md-7 sale_count">{{data.product_count}}件</div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-8" style="border-left:1px solid #eaeaea">
                            <div id="sale_on_off"></div>
                        </div>
                        <div class="col-md-4" style="margin-top: 2rem;">
                            <div>
                                <div class="line_on">线上销售额</div> 
                                <div class="line_on_off_amount">{{data.on_line_sales|currency : ''}}</div>
                            </div>
                            <div style="margin-top: 1rem;">
                                <div class="line_off">线下销售额</div> 
                                <div class="line_on_off_amount">{{data.offline_sales|currency : ''}}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex_channel">
                <div class="flex_lr" ng-repeat="channel_sale in data.channel_sales">
                    <div class="channel_left tit_1">{{channel_sale.channel_name}}<div class="tit_2">{{channel_sale.channel_name2}}</div></div>
                    <div class="channel_right">
                        <div>商品数量：{{channel_sale.product_count}}</div>
                        <div>订单数量：{{channel_sale.order_count}}</div>
                        <div>销售额：{{channel_sale.amount|currency : ''}}</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="div2">
            <div class="row header_5" style="margin-left:0;border:1px solid #eaeaea;border-bottom: 0;">
                <span class="blue_block"></span>
                <div class="col-md-10 title">员工销售统计</div>
            </div>
            <div class="staff_sort">
                <div class="staff_left">
                    <div class="tr_div" style="height:65px;">
                        &nbsp;
                    </div>
                    <div class="tr_div staff_color tit_1" style="height:58px;display: flex;align-items: center;">
                        H5
                    </div>
                    <div class="tr_div" style="height:58px;">
                        <div class="tit_1">导购宝</div>
                        <div class="tit_2">送货到家</div>
                    </div>
                    <div class="tr_div staff_color" style="height:58px;">
                        <div class="tit_1">导购宝</div>
                        <div class="tit_2">自提/自助收银</div>
                    </div>
                    <div class="tr_div tit_1" style="height:58px;display: flex;align-items: center;">
                        小程序
                    </div>
                </div>
                <div class="staff_right" style="overflow-x: scroll;position: absolute;left: 12rem;width: 84.5%;overflow: auto;">
                    <div class="right_column" ng-repeat="employee_sale in data.employee_sales">
                        <div>
                            <div class="tit">{{employee_sale.user_name}}</div>
                            <div class="tit_num">{{employee_sale.amount|currency : ''}}</div>
                        </div>

                        <div ng-class="{staff_color:user_channel_sale.channel_code=='H5'||user_channel_sale.channel_code=='SAA_pickup'}" ng-repeat="user_channel_sale in employee_sale.user_channel_sales">
                            <div>{{user_channel_sale.amount|currency : ''}}</div>
                            <div>{{user_channel_sale.order_count}}单/{{user_channel_sale.product_count}}件</div>
                        </div>
                        <!-- <div>
                            <div>1000.00</div>
                            <div>1单/2件</div>
                        </div>
                        <div class="staff_color">
                            <div>1000.00</div>
                            <div>1单/2件</div>
                        </div>
                        <div>
                            <div>0.00</div>
                            <div>0/0</div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 日期弹框 -->
    <div class="wrapper">
        <div class="dataTab">
            <ul>
                <li id="dp-day"><label class="active"><input type="radio" name="mode" value="day" id="mode_day" />日</label></li>
                <li id="dp-week"><label><input type="radio" name="mode" value="week" id="mode_week" />周</label></li>
                <li id="dp-month"><label><input type="radio" name="mode" value="month" id="mode_month" />月</label></li>
                <li id="dp-range"><label style="border-right: 1px solid rgb(18, 150, 219);"><input type="radio" name="mode" value="customize" id="mode_range" />自定义</label></li>
            </ul>
            <button ng-click="getData()">查询</button>
        </div>
        <div class="picker" id="pickerBox" style="width: 850px;">
            <div style="float: left; width: 100%;">
                <div id="pickerContainer"></div>
                <div class="shopForce">
                    <img src="static/lzsale/src/img/Group.png" />
                </div>
            </div>
        </div>
    </div>
    <div class="background" style="display: none;"></div>
    <!-- <div class="loading loading-detail"> 加载中 ...</div> -->
    <script type="text/javascript">
        var One = {};
        var Two = {};
        var Three = {};
        var Four = {};
        var myCharts = {};
        var needAnimation = false;
    </script>
    <script type="text/javascript">
        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : sParameterName[1];
                }
            }
        };
        var _s = getUrlParameter('_s');
        // _s = (!!_s)?_s:'';
        if(_s == undefined || _s == 'undefined'){
            _s = ''
        }
        window.onload = function(){
      
            var shop_id = getUrlParameter('shop_id');
            var _s = getUrlParameter('_s');
            var _lang = getUrlParameter('lang');
            var _siteId = getUrlParameter('site_id');
            var arr = document.getElementsByClassName('header_a');
            for(var i in arr){
                var href = arr[i].href;
                arr[i].href = href + '?shop_id=' + shop_id + '&lang=' + _lang + '&_s=' + _s + '&site_id=' + _siteId;
            }

            // $('.header_a').each(function(){
            //     if(!$(this).hasClass('active')){
            //         $(this).attr('href', $(this).attr('href') + '&lang=' + _lang);
            //     }
            // })
        //piwik
        var str = window.location.href;
        function getParam(str){
            var obj = {};
            var pos_hash = str.lastIndexOf('#') ;
            if(pos_hash != -1){
                var search_arr = str.substr(str.indexOf('?') + 1 , ( pos_hash - str.indexOf('?') - 1)).split('&');
            }else{
                var search_arr = str.substr(str.indexOf('?') + 1).split('&');
            }
            for(var i = 0; i < search_arr.length; i++){
                var key_value_arr = search_arr[i].split('=');
                obj[key_value_arr[0]] = decodeURIComponent(key_value_arr[1]);
            }
            return obj;
        }

        var params = getParam(str);

        var _paq = _paq || [];
        _paq.push(['enableLinkTracking', true]);

        (function () {
            try {
                //var site_id = 67;
        // 如果site_id是false,则不发送Piwik数据
                if (params.site_id == '' || params.site_id == false) {
                    return
                }
                var u = "https://analytics.nexttao.com/";
        // 当url为空不发送
                if (u == "" || u == "false" || u == false) {
                    return
                }
                _paq.push(['setTrackerUrl', u + 'piwik.php']);
                _paq.push(['setSiteId', params.site_id]);
                if (false) {
        // setCustomVariable表示固定函数名 第二个参数表示第几个变量 第三个参数表示自定义的变量名 第四个参数表示自定义变量值 第五个参数表示
                    _paq.push(['setUserId', ""]);
                }
                _paq.push(['setDocumentTitle', 'Dashboard-多渠道销售']);
                _paq.push(['setCustomVariable', "2", "TenantID", params.tenant_id]);
                _paq.push(['setCustomVariable', "5", "TenantName", params.tenant_name]);
                _paq.push(['setCustomVariable', "1", "Platform", params.Platform]);
                _paq.push(['setCustomVariable', "3", "App version", params.Appversion]);
                _paq.push(['setCustomVariable', "4", "ShopName ", params.ShopName ]);

                _paq.push(['trackPageView']);
                var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
                g.type = 'text/javascript';
                g.async = true;
                g.defer = true;
                g.src = u + 'piwik.js';
                s.parentNode.insertBefore(g, s);
            } catch (e) {
                console.log(e);
            }

        })();
    }

        
    </script>

    <script type="text/javascript" src="static/lzsale/src/libs/echarts/echarts.min.js"></script>

    <script type="text/javascript" src="static/lzsale/src/libs/angular-1.4.8.min.js"></script>
    <script type="text/javascript" src="static/lzsale/src/libs/angular-route.js"></script>
    <script type="text/javascript" src="static/lzsale/src/libs/angular-resource.js"></script>

    <script type="text/javascript" src="static/lzsale/src/js/api.js"></script>
    <script src="static/index/js/lang.js"></script>
    <script src="static/lzsale/src/js/common.js"></script>
</body>
</html>